<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Food - H·ªá Th·ªëng G·ª£i √ù M√≥n ƒÇn Th√¥ng Minh</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'viet-gold': '#D4AF37',
                        'viet-red': '#DA020E',
                        'viet-green': '#228B22',
                        'bamboo': '#8FBC8F'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        
        .hero-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        .nav-item {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .nav-item:hover {
            background: rgba(212, 175, 55, 0.1);
        }
        
        .nav-item.active {
            background: rgba(212, 175, 55, 0.2);
            border-bottom: 3px solid #D4AF37;
        }
        
        .mood-selector {
            font-size: 2.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 12px;
            border-radius: 50%;
            border: 3px solid transparent;
        }
        
        .mood-selector:hover {
            transform: scale(1.15);
            background: rgba(212, 175, 55, 0.15);
            border-color: rgba(212, 175, 55, 0.3);
        }
        
        .mood-selector.active {
            transform: scale(1.2);
            background: rgba(212, 175, 55, 0.25);
            border-color: #D4AF37;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.4);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="bg-white/95 backdrop-blur-md shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <div class="text-3xl">üçú</div>
                    <div>
                        <span class="text-xl font-bold text-viet-red">Smart Food</span>
                        <div class="text-xs text-gray-500">AI Food Recommendation System</div>
                    </div>
                </div>
                
                <!-- Navigation Menu -->
                <div class="hidden md:flex items-center space-x-1" id="mainNav">
                    <div class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700 active" data-page="home">üè† Trang ch·ªß</div>
                    <div class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700" data-page="recommendations">üéØ G·ª£i √Ω m√≥n ƒÉn</div>
                    <div class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700" data-page="mealPlan">üìÖ K·∫ø ho·∫°ch ƒÉn u·ªëng</div>
                    <div class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700" data-page="recipes">üìñ C√¥ng th·ª©c</div>
                    <div class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700" data-page="health">üí™ S·ª©c kh·ªèe</div>
                    <div class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700" data-page="community">üë• C·ªông ƒë·ªìng</div>
                </div>
                
                <!-- User Menu -->
                <div class="flex items-center space-x-4">
                    <div id="userMenu" class="hidden items-center space-x-3">
                        <div class="text-sm">
                            <div class="font-semibold" id="userName">Ch√†o b·∫°n!</div>
                            <div class="text-gray-500 text-xs" id="userLevel">Level 1</div>
                        </div>
                        <img id="userAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23D4AF37'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='16'%3Eüë§%3C/text%3E%3C/svg%3E" class="w-10 h-10 rounded-full cursor-pointer">
                        <button id="logoutBtn" class="text-gray-500 hover:text-gray-700">üö™</button>
                    </div>
                    <div id="loginSection" class="flex items-center space-x-2">
                        <button id="loginBtn" class="bg-viet-red text-white px-4 py-2 rounded-lg font-medium hover:bg-red-600 transition-all">
                            ƒêƒÉng nh·∫≠p
                        </button>
                        <button id="registerBtn" class="border border-viet-red text-viet-red px-4 py-2 rounded-lg font-medium hover:bg-viet-red hover:text-white transition-all">
                            ƒêƒÉng k√Ω
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        
        <!-- Home Page -->
        <div id="homePage" class="page active">
            <!-- Hero Section -->
            <section class="hero-gradient text-white py-16 relative overflow-hidden rounded-2xl my-8">
                <div class="absolute inset-0 bg-black/10"></div>
                <div class="text-center relative z-10 px-8">
                    <div class="mb-8">
                        <div class="text-5xl mb-4">üéØ</div>
                        <h1 class="text-4xl md:text-5xl font-bold mb-4 leading-tight">
                            H·ªá Th·ªëng G·ª£i √ù M√≥n ƒÇn Th√¥ng Minh
                        </h1>
                        <p class="text-lg md:text-xl mb-6 max-w-3xl mx-auto leading-relaxed">
                            S·ª≠ d·ª•ng AI ƒë·ªÉ ph√¢n t√≠ch <span class="text-yellow-300 font-semibold">6 y·∫øu t·ªë quan tr·ªçng</span><br>
                            v√† ƒë∆∞a ra g·ª£i √Ω m√≥n ƒÉn ho√†n h·∫£o d√†nh ri√™ng cho b·∫°n
                        </p>
                        <div class="flex flex-wrap justify-center gap-3 text-sm mb-8">
                            <span class="bg-white/20 px-3 py-1 rounded-full">üèãÔ∏è S·ª©c kh·ªèe</span>
                            <span class="bg-white/20 px-3 py-1 rounded-full">‚è∞ Th·ªùi gian</span>
                            <span class="bg-white/20 px-3 py-1 rounded-full">üìç ƒê·ªãa ƒëi·ªÉm</span>
                            <span class="bg-white/20 px-3 py-1 rounded-full">üòã S·ªü th√≠ch</span>
                            <span class="bg-white/20 px-3 py-1 rounded-full">üå¶Ô∏è T√¢m tr·∫°ng</span>
                            <span class="bg-white/20 px-3 py-1 rounded-full">üéØ M·ª•c ti√™u</span>
                        </div>
                        <button class="nav-item bg-white text-viet-red px-8 py-4 rounded-xl font-bold text-lg hover:bg-gray-100 transition-all transform hover:scale-105" data-page="recommendations">
                            üöÄ B·∫Øt ƒë·∫ßu ngay
                        </button>
                    </div>
                </div>
            </section>

            <!-- Features Grid -->
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 py-16">
                <div class="bg-white rounded-2xl p-8 shadow-lg card-hover text-center">
                    <div class="text-5xl mb-4">ü§ñ</div>
                    <h3 class="text-xl font-bold mb-4">AI Th√¥ng Minh</h3>
                    <p class="text-gray-600">Ph√¢n t√≠ch 6 y·∫øu t·ªë ƒë·ªÉ ƒë∆∞a ra g·ª£i √Ω m√≥n ƒÉn ph√π h·ª£p nh·∫•t v·ªõi b·∫°n</p>
                </div>
                
                <div class="bg-white rounded-2xl p-8 shadow-lg card-hover text-center">
                    <div class="text-5xl mb-4">üìä</div>
                    <h3 class="text-xl font-bold mb-4">Theo D√µi S·ª©c Kh·ªèe</h3>
                    <p class="text-gray-600">Th·ªëng k√™ calories, dinh d∆∞·ª°ng v√† ti·∫øn ƒë·ªô s·ª©c kh·ªèe h√†ng ng√†y</p>
                </div>
                
                <div class="bg-white rounded-2xl p-8 shadow-lg card-hover text-center">
                    <div class="text-5xl mb-4">üìÖ</div>
                    <h3 class="text-xl font-bold mb-4">K·∫ø Ho·∫°ch ƒÇn U·ªëng</h3>
                    <p class="text-gray-600">L·∫≠p k·∫ø ho·∫°ch b·ªØa ƒÉn th√¥ng minh cho c·∫£ tu·∫ßn</p>
                </div>
                
                <div class="bg-white rounded-2xl p-8 shadow-lg card-hover text-center">
                    <div class="text-5xl mb-4">üìñ</div>
                    <h3 class="text-xl font-bold mb-4">Kho C√¥ng Th·ª©c</h3>
                    <p class="text-gray-600">H√†ng ngh√¨n c√¥ng th·ª©c n·∫•u ƒÉn v·ªõi h∆∞·ªõng d·∫´n chi ti·∫øt</p>
                </div>
                
                <div class="bg-white rounded-2xl p-8 shadow-lg card-hover text-center">
                    <div class="text-5xl mb-4">üë•</div>
                    <h3 class="text-xl font-bold mb-4">C·ªông ƒê·ªìng</h3>
                    <p class="text-gray-600">Chia s·∫ª kinh nghi·ªám v√† h·ªçc h·ªèi t·ª´ c·ªông ƒë·ªìng y√™u ·∫©m th·ª±c</p>
                </div>
                
                <div class="bg-white rounded-2xl p-8 shadow-lg card-hover text-center">
                    <div class="text-5xl mb-4">üéØ</div>
                    <h3 class="text-xl font-bold mb-4">C√° Nh√¢n H√≥a</h3>
                    <p class="text-gray-600">ƒêi·ªÅu ch·ªânh tr·ªçng s·ªë theo s·ªü th√≠ch c√° nh√¢n</p>
                </div>
            </div>
        </div>

        <!-- Recommendations Page -->
        <div id="recommendationsPage" class="page py-8">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold mb-4">üéØ G·ª£i √ù M√≥n ƒÇn Th√¥ng Minh</h1>
                <p class="text-gray-600 text-lg">AI ph√¢n t√≠ch 6 y·∫øu t·ªë ƒë·ªÉ t√¨m m√≥n ƒÉn ho√†n h·∫£o cho b·∫°n</p>
            </div>
            
            <!-- Mood Selection -->
            <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
                <h2 class="text-2xl font-bold text-center mb-6">üåü T√¢m tr·∫°ng c·ªßa b·∫°n h√¥m nay?</h2>
                <div class="grid grid-cols-3 md:grid-cols-6 gap-4 justify-items-center" id="moodSelector">
                    <div class="mood-selector" data-mood="happy" title="Vui v·∫ª">üòä</div>
                    <div class="mood-selector" data-mood="sad" title="Bu·ªìn">üò¢</div>
                    <div class="mood-selector" data-mood="stressed" title="CƒÉng th·∫≥ng">üò∞</div>
                    <div class="mood-selector" data-mood="excited" title="H·ª©ng th√∫">ü§©</div>
                    <div class="mood-selector" data-mood="tired" title="M·ªát m·ªèi">üò¥</div>
                    <div class="mood-selector" data-mood="romantic" title="L√£ng m·∫°n">üòç</div>
                </div>
                <div class="text-center mt-4">
                    <span id="selectedMoodText" class="text-lg font-semibold text-viet-red">Ch·ªçn t√¢m tr·∫°ng ƒë·ªÉ b·∫Øt ƒë·∫ßu</span>
                </div>
            </div>

            <!-- Factor Analysis -->
            <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
                <h2 class="text-2xl font-bold text-center mb-6">‚öñÔ∏è ƒêi·ªÅu ch·ªânh ƒë·ªô ∆∞u ti√™n</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="factor-card">
                        <div class="flex items-center justify-between mb-3">
                            <span class="font-semibold flex items-center">
                                <span class="text-2xl mr-2">üèãÔ∏è</span>
                                S·ª©c kh·ªèe
                            </span>
                            <span id="healthValue" class="text-viet-red font-bold">70%</span>
                        </div>
                        <input type="range" id="healthSlider" min="0" max="100" value="70" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                    </div>
                    
                    <div class="factor-card">
                        <div class="flex items-center justify-between mb-3">
                            <span class="font-semibold flex items-center">
                                <span class="text-2xl mr-2">‚è∞</span>
                                Th·ªùi gian
                            </span>
                            <span id="timeValue" class="text-viet-red font-bold">60%</span>
                        </div>
                        <input type="range" id="timeSlider" min="0" max="100" value="60" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                    </div>
                    
                    <div class="factor-card">
                        <div class="flex items-center justify-between mb-3">
                            <span class="font-semibold flex items-center">
                                <span class="text-2xl mr-2">üìç</span>
                                ƒê·ªãa ƒëi·ªÉm
                            </span>
                            <span id="locationValue" class="text-viet-red font-bold">50%</span>
                        </div>
                        <input type="range" id="locationSlider" min="0" max="100" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                    </div>
                    
                    <div class="factor-card">
                        <div class="flex items-center justify-between mb-3">
                            <span class="font-semibold flex items-center">
                                <span class="text-2xl mr-2">üòã</span>
                                S·ªü th√≠ch
                            </span>
                            <span id="preferenceValue" class="text-viet-red font-bold">80%</span>
                        </div>
                        <input type="range" id="preferenceSlider" min="0" max="100" value="80" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                    </div>
                    
                    <div class="factor-card">
                        <div class="flex items-center justify-between mb-3">
                            <span class="font-semibold flex items-center">
                                <span class="text-2xl mr-2">üå¶Ô∏è</span>
                                T√¢m tr·∫°ng
                            </span>
                            <span id="moodValue" class="text-viet-red font-bold">65%</span>
                        </div>
                        <input type="range" id="moodSlider" min="0" max="100" value="65" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                    </div>
                    
                    <div class="factor-card">
                        <div class="flex items-center justify-between mb-3">
                            <span class="font-semibold flex items-center">
                                <span class="text-2xl mr-2">üéØ</span>
                                M·ª•c ti√™u
                            </span>
                            <span id="goalValue" class="text-viet-red font-bold">55%</span>
                        </div>
                        <input type="range" id="goalSlider" min="0" max="100" value="55" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                    </div>
                </div>
                
                <div class="text-center mt-6">
                    <button id="generateRecommendations" class="bg-viet-red text-white px-8 py-3 rounded-xl font-bold hover:bg-red-600 transition-all">
                        ü§ñ T·∫°o g·ª£i √Ω AI
                    </button>
                </div>
            </div>

            <!-- AI Analysis Results -->
            <div id="analysisResults" class="bg-white rounded-2xl shadow-lg p-8 mb-8" style="display: none;">
                <h2 class="text-2xl font-bold text-center mb-6">üß† Ph√¢n T√≠ch AI</h2>
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold mb-4">üìä Tr·ªçng s·ªë y·∫øu t·ªë</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span>üèãÔ∏è S·ª©c kh·ªèe</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-24 bg-gray-200 rounded-full h-2">
                                        <div id="healthBar" class="bg-viet-red h-2 rounded-full transition-all" style="width: 70%"></div>
                                    </div>
                                    <span id="healthPercent" class="text-sm font-semibold">70%</span>
                                </div>
                            </div>
                            <div class="flex justify-between items-center">
                                <span>‚è∞ Th·ªùi gian</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-24 bg-gray-200 rounded-full h-2">
                                        <div id="timeBar" class="bg-viet-red h-2 rounded-full transition-all" style="width: 60%"></div>
                                    </div>
                                    <span id="timePercent" class="text-sm font-semibold">60%</span>
                                </div>
                            </div>
                            <div class="flex justify-between items-center">
                                <span>üòã S·ªü th√≠ch</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-24 bg-gray-200 rounded-full h-2">
                                        <div id="preferenceBar" class="bg-viet-red h-2 rounded-full transition-all" style="width: 80%"></div>
                                    </div>
                                    <span id="preferencePercent" class="text-sm font-semibold">80%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-semibold mb-4">üéØ Khuy·∫øn ngh·ªã</h3>
                        <div class="space-y-2 text-sm">
                            <div id="recommendation1" class="p-3 bg-green-50 rounded-lg">‚úÖ ∆Øu ti√™n m√≥n ƒÉn healthy</div>
                            <div id="recommendation2" class="p-3 bg-blue-50 rounded-lg">‚è±Ô∏è Ch·ªçn m√≥n n·∫•u nhanh</div>
                            <div id="recommendation3" class="p-3 bg-yellow-50 rounded-lg">üòã Ph√π h·ª£p s·ªü th√≠ch c√° nh√¢n</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Food Recommendations -->
            <div id="foodRecommendations" class="bg-white rounded-2xl shadow-lg p-8" style="display: none;">
                <h2 class="text-2xl font-bold text-center mb-6">üçΩÔ∏è G·ª£i √ù M√≥n ƒÇn</h2>
                <div class="grid md:grid-cols-3 gap-8" id="recommendationCards">
                    <!-- Cards will be generated by JavaScript -->
                </div>
                
                <div class="mt-8 text-center">
                    <button id="regenerateBtn" class="bg-viet-red text-white px-8 py-3 rounded-xl font-bold hover:bg-red-600 transition-all">
                        üîÑ T·∫°o g·ª£i √Ω m·ªõi
                    </button>
                </div>
            </div>

            <!-- AI Chat for Recommendations -->
            <div id="recommendationChat" class="bg-white rounded-2xl shadow-lg p-6 mt-8" style="display: none;">
                <h2 class="text-2xl font-bold mb-4 flex items-center">
                    <span class="text-3xl mr-3">ü§ñ</span>
                    Chat v·ªõi AI v·ªÅ m√≥n ƒÉn
                </h2>
                
                <div id="recChatContainer" class="bg-gray-50 rounded-xl p-4 h-48 overflow-y-auto mb-4">
                    <div class="chat-message ai-message mb-3">
                        <div class="flex items-start space-x-3">
                            <div class="text-2xl">ü§ñ</div>
                            <div class="bg-blue-100 rounded-lg p-3 max-w-xs">
                                <p class="text-sm">B·∫°n c√≥ mu·ªën ƒëi·ªÅu ch·ªânh g·ª£i √Ω m√≥n ƒÉn kh√¥ng? T√¥i c√≥ th·ªÉ thay ƒë·ªïi theo s·ªü th√≠ch c·ªßa b·∫°n!</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex space-x-3">
                    <input type="text" id="recChatInput" placeholder="V√≠ d·ª•: T√¥i kh√¥ng th√≠ch cay, thay m√≥n kh√°c..." 
                           class="flex-1 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-viet-red">
                    <button id="sendRecChatBtn" class="bg-viet-red text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-all">
                        G·ª≠i
                    </button>
                </div>
                
                <div class="mt-4 flex flex-wrap gap-2">
                    <button class="rec-quick-chat-btn bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-full text-sm transition-all" 
                            data-message="T√¥i kh√¥ng th√≠ch cay">
                        üå∂Ô∏è Kh√¥ng th√≠ch cay
                    </button>
                    <button class="rec-quick-chat-btn bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-full text-sm transition-all" 
                            data-message="Mu·ªën m√≥n chay">
                        ü•¨ M√≥n chay
                    </button>
                    <button class="rec-quick-chat-btn bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-full text-sm transition-all" 
                            data-message="Th√™m m√≥n tr√°ng mi·ªáng">
                        üç∞ Tr√°ng mi·ªáng
                    </button>
                    <button class="rec-quick-chat-btn bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-full text-sm transition-all" 
                            data-message="M√≥n ƒÉn nhanh">
                        ‚ö° ƒÇn nhanh
                    </button>
                </div>
            </div>
        </div>

        <!-- Meal Plan Page -->
        <div id="mealPlanPage" class="page py-8">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold mb-4">üìÖ K·∫ø Ho·∫°ch ƒÇn U·ªëng</h1>
                <p class="text-gray-600 text-lg">L·∫≠p k·∫ø ho·∫°ch b·ªØa ƒÉn th√¥ng minh cho c·∫£ tu·∫ßn</p>
            </div>
            
            <!-- AI Chat Section -->
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
                <h2 class="text-2xl font-bold mb-4 flex items-center">
                    <span class="text-3xl mr-3">ü§ñ</span>
                    Chat v·ªõi AI Assistant
                </h2>
                
                <div id="chatContainer" class="bg-gray-50 rounded-xl p-4 h-64 overflow-y-auto mb-4">
                    <div class="chat-message ai-message mb-3">
                        <div class="flex items-start space-x-3">
                            <div class="text-2xl">ü§ñ</div>
                            <div class="bg-blue-100 rounded-lg p-3 max-w-xs">
                                <p class="text-sm">Xin ch√†o! T√¥i c√≥ th·ªÉ gi√∫p b·∫°n ƒëi·ªÅu ch·ªânh k·∫ø ho·∫°ch ƒÉn u·ªëng. B·∫°n mu·ªën thay ƒë·ªïi m√≥n n√†o kh√¥ng?</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex space-x-3">
                    <input type="text" id="chatInput" placeholder="V√≠ d·ª•: Thay m√≥n s√°ng th·ª© 2 th√†nh ch√°o..." 
                           class="flex-1 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-viet-red">
                    <button id="sendChatBtn" class="bg-viet-red text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-all">
                        G·ª≠i
                    </button>
                </div>
                
                <div class="mt-4 flex flex-wrap gap-2">
                    <button class="quick-chat-btn bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-full text-sm transition-all" 
                            data-message="T√¥i mu·ªën ƒÉn healthy h∆°n">
                        ü•ó ƒÇn healthy h∆°n
                    </button>
                    <button class="quick-chat-btn bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-full text-sm transition-all" 
                            data-message="Thay ƒë·ªïi m√≥n Vi·ªát Nam">
                        üçú M√≥n Vi·ªát Nam
                    </button>
                    <button class="quick-chat-btn bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-full text-sm transition-all" 
                            data-message="Gi·∫£m calories">
                        üî• Gi·∫£m calories
                    </button>
                    <button class="quick-chat-btn bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-full text-sm transition-all" 
                            data-message="M√≥n n·∫•u nhanh">
                        ‚ö° N·∫•u nhanh
                    </button>
                </div>
            </div>

            <!-- Smart Meal Suggestions -->
            <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <span class="text-3xl mr-3">üéØ</span>
                    G·ª£i √Ω m√≥n ƒÉn th√¥ng minh
                </h2>
                
                <div class="grid md:grid-cols-3 gap-6 mb-6">
                    <div class="text-center">
                        <div class="text-4xl mb-2">üèÉ‚Äç‚ôÇÔ∏è</div>
                        <h3 class="font-semibold mb-2">M·ª•c ti√™u s·ª©c kh·ªèe</h3>
                        <select id="healthGoalSelect" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm">
                            <option value="maintain">Duy tr√¨ s·ª©c kh·ªèe</option>
                            <option value="lose">Gi·∫£m c√¢n</option>
                            <option value="gain">TƒÉng c√¢n</option>
                            <option value="muscle">TƒÉng c∆° b·∫Øp</option>
                        </select>
                    </div>
                    
                    <div class="text-center">
                        <div class="text-4xl mb-2">‚è∞</div>
                        <h3 class="font-semibold mb-2">Th·ªùi gian n·∫•u ƒÉn</h3>
                        <select id="cookingTimeSelect" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm">
                            <option value="any">Kh√¥ng gi·ªõi h·∫°n</option>
                            <option value="quick">Nhanh (< 30 ph√∫t)</option>
                            <option value="medium">Trung b√¨nh (30-60 ph√∫t)</option>
                            <option value="slow">Ch·∫≠m (> 60 ph√∫t)</option>
                        </select>
                    </div>
                    
                    <div class="text-center">
                        <div class="text-4xl mb-2">üå±</div>
                        <h3 class="font-semibold mb-2">Ch·∫ø ƒë·ªô ƒÉn</h3>
                        <select id="dietTypeSelect" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm">
                            <option value="normal">B√¨nh th∆∞·ªùng</option>
                            <option value="vegetarian">Chay</option>
                            <option value="healthy">Healthy</option>
                            <option value="traditional">Truy·ªÅn th·ªëng</option>
                        </select>
                    </div>
                </div>
                
                <div class="text-center">
                    <button id="generateSmartPlanBtn" class="bg-gradient-to-r from-purple-600 to-blue-600 text-white px-8 py-3 rounded-xl font-bold hover:from-purple-700 hover:to-blue-700 transition-all">
                        ü§ñ T·∫°o k·∫ø ho·∫°ch th√¥ng minh
                    </button>
                </div>
            </div>

            <!-- Weekly Meal Plan -->
            <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">üìã K·∫ø ho·∫°ch tu·∫ßn n√†y</h2>
                    <div class="flex space-x-2">
                        <button id="prevWeekBtn" class="bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-lg transition-all">
                            ‚Üê Tu·∫ßn tr∆∞·ªõc
                        </button>
                        <button id="nextWeekBtn" class="bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-lg transition-all">
                            Tu·∫ßn sau ‚Üí
                        </button>
                    </div>
                </div>
                
                <div id="weeklyPlan" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-7 gap-4">
                    <!-- Days will be generated by JavaScript -->
                </div>
                
                <div class="mt-8 flex justify-center space-x-4">
                    <button id="generatePlanBtn" class="bg-viet-red text-white px-8 py-3 rounded-xl font-bold hover:bg-red-600 transition-all">
                        üéØ T·∫°o k·∫ø ho·∫°ch m·ªõi
                    </button>
                    <button id="savePlanBtn" class="bg-green-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-green-700 transition-all">
                        üíæ L∆∞u k·∫ø ho·∫°ch
                    </button>
                </div>
            </div>

            <!-- Nutrition Summary -->
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-2xl font-bold mb-6">üìä T·ªïng quan dinh d∆∞·ª°ng tu·∫ßn</h2>
                <div class="grid md:grid-cols-4 gap-6">
                    <div class="text-center">
                        <div class="text-4xl mb-2">üî•</div>
                        <div class="text-2xl font-bold text-red-600" id="weeklyCalories">2,100</div>
                        <div class="text-sm text-gray-500">Calories/ng√†y</div>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl mb-2">ü•©</div>
                        <div class="text-2xl font-bold text-blue-600" id="weeklyProtein">95g</div>
                        <div class="text-sm text-gray-500">Protein/ng√†y</div>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl mb-2">üçû</div>
                        <div class="text-2xl font-bold text-green-600" id="weeklyCarbs">250g</div>
                        <div class="text-sm text-gray-500">Carbs/ng√†y</div>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl mb-2">ü•ë</div>
                        <div class="text-2xl font-bold text-yellow-600" id="weeklyFat">70g</div>
                        <div class="text-sm text-gray-500">Fat/ng√†y</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recipes Page -->
        <div id="recipesPage" class="page py-8">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold mb-4">üìñ Kho C√¥ng Th·ª©c</h1>
                <p class="text-gray-600 text-lg">Kh√°m ph√° h√†ng ngh√¨n c√¥ng th·ª©c n·∫•u ƒÉn chi ti·∫øt</p>
            </div>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover">
                    <div class="p-6">
                        <div class="text-6xl text-center mb-4">üçú</div>
                        <h3 class="text-xl font-bold mb-2">Ph·ªü B√≤ H√† N·ªôi</h3>
                        <p class="text-gray-600 text-sm mb-4">C√¥ng th·ª©c ph·ªü b√≤ truy·ªÅn th·ªëng v·ªõi n∆∞·ªõc d√πng trong v·∫Øt</p>
                        <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                            <span>‚è±Ô∏è 45 ph√∫t</span>
                            <span>üë• 4 ng∆∞·ªùi</span>
                            <span>‚≠ê 4.8</span>
                        </div>
                        <button class="w-full bg-viet-red text-white py-2 rounded-xl font-semibold hover:bg-red-600 transition-all">
                            Xem chi ti·∫øt
                        </button>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover">
                    <div class="p-6">
                        <div class="text-6xl text-center mb-4">ü•ó</div>
                        <h3 class="text-xl font-bold mb-2">Salad Quinoa Healthy</h3>
                        <p class="text-gray-600 text-sm mb-4">Salad quinoa b·ªï d∆∞·ª°ng v·ªõi rau c·ªß t∆∞∆°i v√† s·ªët chanh d√¢y</p>
                        <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                            <span>‚è±Ô∏è 20 ph√∫t</span>
                            <span>üë• 2 ng∆∞·ªùi</span>
                            <span>‚≠ê 4.6</span>
                        </div>
                        <button class="w-full bg-viet-red text-white py-2 rounded-xl font-semibold hover:bg-red-600 transition-all">
                            Xem chi ti·∫øt
                        </button>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover">
                    <div class="p-6">
                        <div class="text-6xl text-center mb-4">üç≤</div>
                        <h3 class="text-xl font-bold mb-2">B√∫n B√≤ Hu·∫ø</h3>
                        <p class="text-gray-600 text-sm mb-4">B√∫n b√≤ cay n·ªìng ƒë·∫∑c tr∆∞ng mi·ªÅn Trung v·ªõi ch·∫£ cua</p>
                        <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                            <span>‚è±Ô∏è 60 ph√∫t</span>
                            <span>üë• 4 ng∆∞·ªùi</span>
                            <span>‚≠ê 4.7</span>
                        </div>
                        <button class="w-full bg-viet-red text-white py-2 rounded-xl font-semibold hover:bg-red-600 transition-all">
                            Xem chi ti·∫øt
                        </button>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover">
                    <div class="p-6">
                        <div class="text-6xl text-center mb-4">üçõ</div>
                        <h3 class="text-xl font-bold mb-2">C∆°m G√† H·∫£i Nam</h3>
                        <p class="text-gray-600 text-sm mb-4">C∆°m g√† th∆°m ngon v·ªõi n∆∞·ªõc ch·∫•m ƒë·∫∑c bi·ªát</p>
                        <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                            <span>‚è±Ô∏è 50 ph√∫t</span>
                            <span>üë• 3 ng∆∞·ªùi</span>
                            <span>‚≠ê 4.5</span>
                        </div>
                        <button class="w-full bg-viet-red text-white py-2 rounded-xl font-semibold hover:bg-red-600 transition-all">
                            Xem chi ti·∫øt
                        </button>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover">
                    <div class="p-6">
                        <div class="text-6xl text-center mb-4">ü•ò</div>
                        <h3 class="text-xl font-bold mb-2">C√† Ri G√†</h3>
                        <p class="text-gray-600 text-sm mb-4">C√† ri g√† ƒë·∫≠m ƒë√† v·ªõi n∆∞·ªõc c·ªët d·ª´a v√† gia v·ªã</p>
                        <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                            <span>‚è±Ô∏è 40 ph√∫t</span>
                            <span>üë• 4 ng∆∞·ªùi</span>
                            <span>‚≠ê 4.4</span>
                        </div>
                        <button class="w-full bg-viet-red text-white py-2 rounded-xl font-semibold hover:bg-red-600 transition-all">
                            Xem chi ti·∫øt
                        </button>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover">
                    <div class="p-6">
                        <div class="text-6xl text-center mb-4">üçù</div>
                        <h3 class="text-xl font-bold mb-2">M√¨ √ù Carbonara</h3>
                        <p class="text-gray-600 text-sm mb-4">M√¨ √ù Carbonara ki·ªÉu √ù v·ªõi bacon v√† ph√¥ mai</p>
                        <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                            <span>‚è±Ô∏è 25 ph√∫t</span>
                            <span>üë• 2 ng∆∞·ªùi</span>
                            <span>‚≠ê 4.6</span>
                        </div>
                        <button class="w-full bg-viet-red text-white py-2 rounded-xl font-semibold hover:bg-red-600 transition-all">
                            Xem chi ti·∫øt
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Health Page -->
        <div id="healthPage" class="page py-8">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold mb-4">üí™ Theo D√µi S·ª©c Kh·ªèe</h1>
                <p class="text-gray-600 text-lg">Th·ªëng k√™ chi ti·∫øt v·ªÅ dinh d∆∞·ª°ng v√† ti·∫øn ƒë·ªô s·ª©c kh·ªèe</p>
            </div>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-gradient-to-r from-red-500 to-pink-600 text-white rounded-2xl p-6 text-center">
                    <div class="text-3xl mb-2">üî•</div>
                    <div class="text-2xl font-bold">1,650</div>
                    <div class="text-sm opacity-90">/ 2,000 calories</div>
                    <div class="w-full bg-white/20 rounded-full h-2 mt-2">
                        <div class="bg-white h-2 rounded-full" style="width: 82.5%"></div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-2xl p-6 text-center">
                    <div class="text-3xl mb-2">ü•©</div>
                    <div class="text-2xl font-bold">95g</div>
                    <div class="text-sm opacity-90">/ 120g protein</div>
                    <div class="w-full bg-white/20 rounded-full h-2 mt-2">
                        <div class="bg-white h-2 rounded-full" style="width: 79%"></div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-green-500 to-teal-600 text-white rounded-2xl p-6 text-center">
                    <div class="text-3xl mb-2">üçû</div>
                    <div class="text-2xl font-bold">180g</div>
                    <div class="text-sm opacity-90">/ 250g carbs</div>
                    <div class="w-full bg-white/20 rounded-full h-2 mt-2">
                        <div class="bg-white h-2 rounded-full" style="width: 72%"></div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-2xl p-6 text-center">
                    <div class="text-3xl mb-2">ü•ë</div>
                    <div class="text-2xl font-bold">45g</div>
                    <div class="text-sm opacity-90">/ 65g fat</div>
                    <div class="w-full bg-white/20 rounded-full h-2 mt-2">
                        <div class="bg-white h-2 rounded-full" style="width: 69%"></div>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h3 class="text-2xl font-semibold mb-6">üçΩÔ∏è L·ªãch s·ª≠ b·ªØa ƒÉn h√¥m nay</h3>
                <div class="space-y-4">
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl">
                        <div class="flex items-center space-x-4">
                            <div class="text-3xl">üçú</div>
                            <div>
                                <div class="font-semibold">Ph·ªü B√≤</div>
                                <div class="text-sm text-gray-500">07:30 ‚Ä¢ S√°ng</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-viet-red">350</div>
                            <div class="text-xs text-gray-500">calories</div>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl">
                        <div class="flex items-center space-x-4">
                            <div class="text-3xl">ü•ó</div>
                            <div>
                                <div class="font-semibold">Salad Quinoa</div>
                                <div class="text-sm text-gray-500">12:15 ‚Ä¢ Tr∆∞a</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-viet-red">280</div>
                            <div class="text-xs text-gray-500">calories</div>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl">
                        <div class="flex items-center space-x-4">
                            <div class="text-3xl">ü•§</div>
                            <div>
                                <div class="font-semibold">Smoothie</div>
                                <div class="text-sm text-gray-500">15:30 ‚Ä¢ Snack</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-viet-red">150</div>
                            <div class="text-xs text-gray-500">calories</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Community Page -->
        <div id="communityPage" class="page py-8">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold mb-4">üë• C·ªông ƒê·ªìng ·∫®m Th·ª±c</h1>
                <p class="text-gray-600 text-lg">Chia s·∫ª kinh nghi·ªám v√† k·∫øt n·ªëi v·ªõi nh·ªØng ng∆∞·ªùi y√™u ·∫©m th·ª±c</p>
            </div>
            
            <div class="space-y-6">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex items-start space-x-4">
                        <div class="text-3xl">üë®‚Äçüç≥</div>
                        <div class="flex-1">
                            <div class="flex items-center space-x-2 mb-2">
                                <span class="font-semibold">Chef Minh</span>
                                <span class="text-sm text-gray-500">2 gi·ªù tr∆∞·ªõc</span>
                            </div>
                            <h4 class="font-bold text-lg mb-2">B√≠ quy·∫øt l√†m ph·ªü b√≤ n∆∞·ªõc d√πng trong v·∫Øt</h4>
                            <p class="text-gray-600 mb-4">Sau 10 nƒÉm l√†m ngh·ªÅ, t√¥i mu·ªën chia s·∫ª b√≠ quy·∫øt ƒë·ªÉ c√≥ n∆∞·ªõc d√πng ph·ªü trong v·∫Øt v√† th∆°m ngon. ƒêi·ªÅu quan tr·ªçng nh·∫•t l√†...</p>
                            <div class="text-6xl text-center my-4">üçú</div>
                            <div class="flex items-center space-x-6 text-sm text-gray-500">
                                <button class="flex items-center space-x-1 hover:text-viet-red transition-all">
                                    <span>üëç</span>
                                    <span>245</span>
                                </button>
                                <button class="flex items-center space-x-1 hover:text-viet-red transition-all">
                                    <span>üí¨</span>
                                    <span>32</span>
                                </button>
                                <button class="flex items-center space-x-1 hover:text-viet-red transition-all">
                                    <span>üì§</span>
                                    <span>18</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex items-start space-x-4">
                        <div class="text-3xl">üë©‚Äçüç≥</div>
                        <div class="flex-1">
                            <div class="flex items-center space-x-2 mb-2">
                                <span class="font-semibold">Healthy Mom</span>
                                <span class="text-sm text-gray-500">4 gi·ªù tr∆∞·ªõc</span>
                            </div>
                            <h4 class="font-bold text-lg mb-2">B·ªØa s√°ng healthy cho c·∫£ gia ƒë√¨nh</h4>
                            <p class="text-gray-600 mb-4">Smoothie bowl v·ªõi granola t·ª± l√†m v√† tr√°i c√¢y t∆∞∆°i. C√°c b√© r·∫•t th√≠ch v√† ƒë·∫ßy ƒë·ªß dinh d∆∞·ª°ng cho ng√†y m·ªõi!</p>
                            <div class="text-6xl text-center my-4">üçì</div>
                            <div class="flex items-center space-x-6 text-sm text-gray-500">
                                <button class="flex items-center space-x-1 hover:text-viet-red transition-all">
                                    <span>üëç</span>
                                    <span>189</span>
                                </button>
                                <button class="flex items-center space-x-1 hover:text-viet-red transition-all">
                                    <span>üí¨</span>
                                    <span>24</span>
                                </button>
                                <button class="flex items-center space-x-1 hover:text-viet-red transition-all">
                                    <span>üì§</span>
                                    <span>12</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex items-start space-x-4">
                        <div class="text-3xl">üçΩÔ∏è</div>
                        <div class="flex-1">
                            <div class="flex items-center space-x-2 mb-2">
                                <span class="font-semibold">Foodie H√† N·ªôi</span>
                                <span class="text-sm text-gray-500">6 gi·ªù tr∆∞·ªõc</span>
                            </div>
                            <h4 class="font-bold text-lg mb-2">L√†m sao ƒë·ªÉ b√°nh m√¨ gi√≤n l√¢u h∆°n?</h4>
                            <p class="text-gray-600 mb-4">M√¨nh hay l√†m b√°nh m√¨ ·ªü nh√† nh∆∞ng kh√¥ng gi√≤n ƒë∆∞·ª£c l√¢u nh∆∞ ngo√†i h√†ng. C√≥ b·∫°n n√†o bi·∫øt b√≠ quy·∫øt kh√¥ng ·∫°?</p>
                            <div class="text-6xl text-center my-4">ü•ñ</div>
                            <div class="flex items-center space-x-6 text-sm text-gray-500">
                                <button class="flex items-center space-x-1 hover:text-viet-red transition-all">
                                    <span>üëç</span>
                                    <span>67</span>
                                </button>
                                <button class="flex items-center space-x-1 hover:text-viet-red transition-all">
                                    <span>üí¨</span>
                                    <span>45</span>
                                </button>
                                <button class="flex items-center space-x-1 hover:text-viet-red transition-all">
                                    <span>üì§</span>
                                    <span>8</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification bg-white rounded-xl shadow-2xl p-4 max-w-sm">
        <div class="flex items-center space-x-3">
            <div class="text-2xl" id="notificationIcon">‚úÖ</div>
            <div>
                <div class="font-semibold" id="notificationTitle">Th√†nh c√¥ng!</div>
                <div class="text-sm text-gray-600" id="notificationMessage">Thao t√°c ƒë√£ ƒë∆∞·ª£c th·ª±c hi·ªán</div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let currentPage = 'home';
        let selectedMood = null;
        let factorWeights = {
            health: 70,
            time: 60,
            location: 50,
            preference: 80,
            mood: 65,
            goal: 55
        };

        // Food database
        const foodDatabase = [
            // Breakfast foods
            { name: "Ph·ªü B√≤ H√† N·ªôi", emoji: "üçú", description: "M√≥n ph·ªü truy·ªÅn th·ªëng v·ªõi n∆∞·ªõc d√πng trong v·∫Øt", health: 75, time: 30, preference: 90, mood: ["happy", "tired"], calories: 350, cookTime: "45 ph√∫t", type: "breakfast", category: "traditional" },
            { name: "Smoothie Bowl", emoji: "üçì", description: "Smoothie bowl v·ªõi granola v√† tr√°i c√¢y t∆∞∆°i", health: 90, time: 90, preference: 75, mood: ["excited", "happy"], calories: 250, cookTime: "15 ph√∫t", type: "breakfast", category: "healthy" },
            { name: "B√°nh M√¨ Th·ªãt N∆∞·ªõng", emoji: "ü•ñ", description: "B√°nh m√¨ gi√≤n v·ªõi th·ªãt n∆∞·ªõng th∆°m l·ª´ng", health: 65, time: 80, preference: 92, mood: ["happy", "tired"], calories: 320, cookTime: "25 ph√∫t", type: "breakfast", category: "traditional" },
            { name: "Ch√°o T√¥m", emoji: "ü•£", description: "Ch√°o t√¥m m·ªÅm m·ªãn, b·ªï d∆∞·ª°ng", health: 85, time: 70, preference: 80, mood: ["sad", "tired"], calories: 200, cookTime: "35 ph√∫t", type: "breakfast", category: "healthy" },
            { name: "B√°nh Cu·ªën", emoji: "ü•ü", description: "B√°nh cu·ªën m·ªèng v·ªõi nh√¢n th·ªãt th∆°m ngon", health: 80, time: 60, preference: 85, mood: ["happy"], calories: 280, cookTime: "40 ph√∫t", type: "breakfast", category: "traditional" },
            { name: "Tr·ª©ng Chi√™n", emoji: "üç≥", description: "Tr·ª©ng chi√™n ƒë∆°n gi·∫£n, nhanh g·ªçn", health: 70, time: 95, preference: 80, mood: ["tired"], calories: 180, cookTime: "10 ph√∫t", type: "breakfast", category: "quick" },
            
            // Lunch foods
            { name: "C∆°m G√† H·∫£i Nam", emoji: "üçõ", description: "C∆°m g√† th∆°m ngon v·ªõi n∆∞·ªõc ch·∫•m ƒë·∫∑c bi·ªát", health: 80, time: 60, preference: 88, mood: ["romantic", "happy"], calories: 380, cookTime: "50 ph√∫t", type: "lunch", category: "traditional" },
            { name: "Salad Quinoa", emoji: "ü•ó", description: "Salad healthy v·ªõi quinoa v√† rau c·ªß t∆∞∆°i", health: 95, time: 85, preference: 70, mood: ["stressed", "excited"], calories: 280, cookTime: "20 ph√∫t", type: "lunch", category: "healthy" },
            { name: "B√∫n B√≤ Hu·∫ø", emoji: "üç≤", description: "B√∫n b√≤ cay n·ªìng ƒë·∫∑c tr∆∞ng mi·ªÅn Trung", health: 70, time: 40, preference: 85, mood: ["happy", "excited"], calories: 420, cookTime: "60 ph√∫t", type: "lunch", category: "traditional" },
            { name: "C∆°m T·∫•m", emoji: "üçö", description: "C∆°m t·∫•m s∆∞·ªùn n∆∞·ªõng ƒë·∫∑c s·∫£n S√†i G√≤n", health: 65, time: 50, preference: 90, mood: ["happy"], calories: 450, cookTime: "45 ph√∫t", type: "lunch", category: "traditional" },
            { name: "M√¨ Qu·∫£ng", emoji: "üçú", description: "M√¨ Qu·∫£ng ƒë·∫≠m ƒë√† h∆∞∆°ng v·ªã mi·ªÅn Trung", health: 75, time: 45, preference: 85, mood: ["excited"], calories: 380, cookTime: "55 ph√∫t", type: "lunch", category: "traditional" },
            { name: "Salad G√† N∆∞·ªõng", emoji: "ü•ô", description: "Salad v·ªõi g√† n∆∞·ªõng v√† rau xanh t∆∞∆°i", health: 90, time: 80, preference: 75, mood: ["stressed"], calories: 320, cookTime: "25 ph√∫t", type: "lunch", category: "healthy" },
            
            // Dinner foods
            { name: "L·∫©u Th√°i", emoji: "üç≤", description: "L·∫©u Th√°i chua cay v·ªõi h·∫£i s·∫£n t∆∞∆°i ngon", health: 75, time: 50, preference: 85, mood: ["excited", "romantic"], calories: 300, cookTime: "40 ph√∫t", type: "dinner", category: "traditional" },
            { name: "C√† Ri G√†", emoji: "ü•ò", description: "C√† ri g√† ƒë·∫≠m ƒë√† v·ªõi n∆∞·ªõc c·ªët d·ª´a", health: 70, time: 55, preference: 80, mood: ["romantic"], calories: 400, cookTime: "50 ph√∫t", type: "dinner", category: "traditional" },
            { name: "C√° N∆∞·ªõng", emoji: "üêü", description: "C√° n∆∞·ªõng th∆°m l·ª´ng v·ªõi rau s·ªëng", health: 85, time: 70, preference: 85, mood: ["happy"], calories: 350, cookTime: "35 ph√∫t", type: "dinner", category: "healthy" },
            { name: "Th·ªãt Kho T√†u", emoji: "ü•©", description: "Th·ªãt kho t√†u ƒë·∫≠m ƒë√† truy·ªÅn th·ªëng", health: 60, time: 40, preference: 88, mood: ["sad", "tired"], calories: 420, cookTime: "70 ph√∫t", type: "dinner", category: "traditional" },
            { name: "Canh Chua", emoji: "üçú", description: "Canh chua c√° thanh m√°t mi·ªÅn Nam", health: 80, time: 65, preference: 80, mood: ["happy"], calories: 180, cookTime: "30 ph√∫t", type: "dinner", category: "healthy" },
            { name: "G·ªèi Cu·ªën", emoji: "üåØ", description: "G·ªèi cu·ªën t∆∞∆°i m√°t v·ªõi t√¥m th·ªãt", health: 90, time: 85, preference: 75, mood: ["excited"], calories: 220, cookTime: "20 ph√∫t", type: "dinner", category: "healthy" },
            
            // Vegetarian options
            { name: "C∆°m Chay", emoji: "üçö", description: "C∆°m chay ƒë·∫ßy ƒë·ªß dinh d∆∞·ª°ng", health: 85, time: 70, preference: 70, mood: ["stressed"], calories: 300, cookTime: "35 ph√∫t", type: "lunch", category: "vegetarian" },
            { name: "Ph·ªü Chay", emoji: "üçú", description: "Ph·ªü chay thanh ƒë·∫°m, b·ªï d∆∞·ª°ng", health: 90, time: 60, preference: 75, mood: ["sad"], calories: 280, cookTime: "40 ph√∫t", type: "breakfast", category: "vegetarian" },
            { name: "Salad Tr√°i C√¢y", emoji: "ü•ó", description: "Salad tr√°i c√¢y t∆∞∆°i m√°t", health: 95, time: 90, preference: 70, mood: ["excited"], calories: 150, cookTime: "15 ph√∫t", type: "breakfast", category: "vegetarian" },
            
            // Quick meals
            { name: "Sandwich", emoji: "ü•™", description: "Sandwich nhanh g·ªçn, ti·ªán l·ª£i", health: 70, time: 95, preference: 80, mood: ["tired"], calories: 300, cookTime: "10 ph√∫t", type: "breakfast", category: "quick" },
            { name: "M√¨ √ù", emoji: "üçù", description: "M√¨ √ù s·ªët c√† chua th∆°m ngon", health: 65, time: 85, preference: 85, mood: ["happy"], calories: 380, cookTime: "20 ph√∫t", type: "lunch", category: "quick" },
            { name: "C∆°m Chi√™n", emoji: "üçõ", description: "C∆°m chi√™n d∆∞∆°ng ch√¢u ƒë·∫≠m ƒë√†", health: 60, time: 80, preference: 90, mood: ["excited"], calories: 420, cookTime: "25 ph√∫t", type: "dinner", category: "quick" }
        ];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeNavigation();
            initializeAuth();
            initializeRecommendationSystem();
            initializeMealPlan();
        });

        // Navigation system
        function initializeNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    const targetPage = this.dataset.page;
                    if (targetPage) {
                        navigateToPage(targetPage);
                    }
                });
            });
        }

        function navigateToPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show target page
            const targetPage = document.getElementById(pageName + 'Page');
            if (targetPage) {
                targetPage.classList.add('active');
                currentPage = pageName;
                
                // Update navigation active state
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                const activeNavItem = document.querySelector(`[data-page="${pageName}"]`);
                if (activeNavItem) {
                    activeNavItem.classList.add('active');
                }
            }
        }

        // Authentication system
        function initializeAuth() {
            const loginBtn = document.getElementById('loginBtn');
            const registerBtn = document.getElementById('registerBtn');
            const logoutBtn = document.getElementById('logoutBtn');

            if (loginBtn) {
                loginBtn.addEventListener('click', () => {
                    showNotification('üîê', 'ƒêƒÉng nh·∫≠p', 'T√≠nh nƒÉng ƒëƒÉng nh·∫≠p s·∫Ω s·ªõm ƒë∆∞·ª£c ra m·∫Øt!');
                });
            }

            if (registerBtn) {
                registerBtn.addEventListener('click', () => {
                    showNotification('üìù', 'ƒêƒÉng k√Ω', 'T√≠nh nƒÉng ƒëƒÉng k√Ω s·∫Ω s·ªõm ƒë∆∞·ª£c ra m·∫Øt!');
                });
            }

            if (logoutBtn) {
                logoutBtn.addEventListener('click', () => {
                    showNotification('üëã', 'ƒêƒÉng xu·∫•t', 'H·∫πn g·∫∑p l·∫°i b·∫°n!');
                });
            }
        }

        // Recommendation system
        function initializeRecommendationSystem() {
            // Mood selector
            const moodSelectors = document.querySelectorAll('.mood-selector');
            moodSelectors.forEach(selector => {
                selector.addEventListener('click', function() {
                    // Remove active class from all selectors
                    moodSelectors.forEach(s => s.classList.remove('active'));
                    // Add active class to clicked selector
                    this.classList.add('active');
                    selectedMood = this.dataset.mood;
                    
                    // Update mood text
                    const moodText = document.getElementById('selectedMoodText');
                    const moodNames = {
                        'happy': 'Vui v·∫ª üòä',
                        'sad': 'Bu·ªìn üò¢',
                        'stressed': 'CƒÉng th·∫≥ng üò∞',
                        'excited': 'H·ª©ng th√∫ ü§©',
                        'tired': 'M·ªát m·ªèi üò¥',
                        'romantic': 'L√£ng m·∫°n üòç'
                    };
                    if (moodText) {
                        moodText.textContent = `T√¢m tr·∫°ng: ${moodNames[selectedMood]}`;
                    }
                });
            });

            // Factor sliders
            const sliders = ['health', 'time', 'location', 'preference', 'mood', 'goal'];
            sliders.forEach(factor => {
                const slider = document.getElementById(factor + 'Slider');
                const valueDisplay = document.getElementById(factor + 'Value');
                
                if (slider && valueDisplay) {
                    slider.addEventListener('input', function() {
                        const value = this.value;
                        factorWeights[factor] = parseInt(value);
                        valueDisplay.textContent = value + '%';
                    });
                }
            });

            // Generate recommendations button
            const generateBtn = document.getElementById('generateRecommendations');
            if (generateBtn) {
                generateBtn.addEventListener('click', generateRecommendations);
            }

            // Regenerate button
            const regenerateBtn = document.getElementById('regenerateBtn');
            if (regenerateBtn) {
                regenerateBtn.addEventListener('click', generateRecommendations);
            }

            // Initialize recommendation chat
            initializeRecommendationChat();
        }

        function generateRecommendations() {
            // Show analysis results
            const analysisResults = document.getElementById('analysisResults');
            const foodRecommendations = document.getElementById('foodRecommendations');
            
            if (analysisResults) {
                analysisResults.style.display = 'block';
                updateAnalysisDisplay();
            }
            
            // Generate food recommendations after a short delay
            setTimeout(() => {
                if (foodRecommendations) {
                    foodRecommendations.style.display = 'block';
                    generateFoodCards();
                }
                
                // Show recommendation chat
                const recommendationChat = document.getElementById('recommendationChat');
                if (recommendationChat) {
                    recommendationChat.style.display = 'block';
                }
                
                // Scroll to results
                analysisResults.scrollIntoView({ behavior: 'smooth' });
            }, 1000);
            
            showNotification('ü§ñ', 'AI ƒëang ph√¢n t√≠ch', 'ƒêang t·∫°o g·ª£i √Ω m√≥n ƒÉn ph√π h·ª£p...');
        }

        function updateAnalysisDisplay() {
            // Update progress bars
            const factors = ['health', 'time', 'preference'];
            factors.forEach(factor => {
                const bar = document.getElementById(factor + 'Bar');
                const percent = document.getElementById(factor + 'Percent');
                if (bar && percent) {
                    bar.style.width = factorWeights[factor] + '%';
                    percent.textContent = factorWeights[factor] + '%';
                }
            });

            // Update recommendations based on weights
            const rec1 = document.getElementById('recommendation1');
            const rec2 = document.getElementById('recommendation2');
            const rec3 = document.getElementById('recommendation3');

            if (rec1 && rec2 && rec3) {
                if (factorWeights.health > 70) {
                    rec1.textContent = '‚úÖ ∆Øu ti√™n m√≥n ƒÉn healthy v√† √≠t calories';
                } else {
                    rec1.textContent = 'üçΩÔ∏è T·∫≠p trung v√†o h∆∞∆°ng v·ªã v√† s·ª± h√†i l√≤ng';
                }

                if (factorWeights.time > 70) {
                    rec2.textContent = '‚è±Ô∏è Ch·ªçn m√≥n n·∫•u nhanh d∆∞·ªõi 30 ph√∫t';
                } else {
                    rec2.textContent = 'üë®‚Äçüç≥ C√≥ th·ªÉ ch·ªçn m√≥n ph·ª©c t·∫°p h∆°n';
                }

                if (selectedMood) {
                    const moodRecommendations = {
                        'happy': 'üòä M√≥n ƒÉn vui t∆∞∆°i, ƒë·∫ßy m√†u s·∫Øc',
                        'sad': 'ü§ó M√≥n ƒÉn ·∫•m √°p, d·ªÖ ti√™u h√≥a',
                        'stressed': 'üßò M√≥n ƒÉn nh·∫π nh√†ng, gi·∫£m stress',
                        'excited': 'üéâ M√≥n ƒÉn th√∫ v·ªã, ƒë·∫≠m ƒë√†',
                        'tired': 'üí§ M√≥n ƒÉn b·ªï d∆∞·ª°ng, d·ªÖ ƒÉn',
                        'romantic': 'üíï M√≥n ƒÉn tinh t·∫ø, l√£ng m·∫°n'
                    };
                    rec3.textContent = moodRecommendations[selectedMood] || 'üòã Ph√π h·ª£p s·ªü th√≠ch c√° nh√¢n';
                }
            }
        }

        function calculateFoodScore(food) {
            let score = 0;
            let totalWeight = 0;

            // Health factor
            if (factorWeights.health > 0) {
                score += (food.health / 100) * factorWeights.health;
                totalWeight += factorWeights.health;
            }

            // Time factor (higher time score means quicker to prepare)
            if (factorWeights.time > 0) {
                score += (food.time / 100) * factorWeights.time;
                totalWeight += factorWeights.time;
            }

            // Preference factor
            if (factorWeights.preference > 0) {
                score += (food.preference / 100) * factorWeights.preference;
                totalWeight += factorWeights.preference;
            }

            // Mood factor
            if (selectedMood && food.mood.includes(selectedMood)) {
                score += factorWeights.mood;
                totalWeight += factorWeights.mood;
            }

            return totalWeight > 0 ? (score / totalWeight) * 100 : 0;
        }

        function generateFoodCards() {
            const container = document.getElementById('recommendationCards');
            if (!container) return;

            // Calculate scores for all foods
            const scoredFoods = foodDatabase.map(food => ({
                ...food,
                score: calculateFoodScore(food)
            }));

            // Sort by score and take top 3
            const topFoods = scoredFoods.sort((a, b) => b.score - a.score).slice(0, 3);

            // Generate cards
            container.innerHTML = topFoods.map((food, index) => {
                const colors = [
                    'from-blue-500 to-purple-600',
                    'from-green-500 to-teal-600',
                    'from-orange-500 to-red-600'
                ];
                
                const textColors = [
                    'text-blue-600',
                    'text-green-600',
                    'text-orange-600'
                ];

                return `
                    <div class="bg-gradient-to-r ${colors[index]} text-white rounded-xl p-6 text-center card-hover">
                        <div class="text-4xl mb-3">${food.emoji}</div>
                        <h3 class="text-xl font-bold mb-2">${food.name}</h3>
                        <p class="text-sm opacity-90 mb-4">${food.description}</p>
                        <div class="text-2xl font-bold mb-2">${Math.round(food.score)}%</div>
                        <div class="text-sm opacity-80 mb-4">ƒê·ªô ph√π h·ª£p</div>
                        <div class="text-xs opacity-75 mb-4">
                            ${food.calories} calories ‚Ä¢ ${food.cookTime}
                        </div>
                        <button class="bg-white ${textColors[index]} px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition-all" onclick="selectFood('${food.name}')">
                            ${index === 0 ? 'Ch·ªçn m√≥n n√†y' : index === 1 ? 'Xem c√¥ng th·ª©c' : 'Th√™m y√™u th√≠ch'}
                        </button>
                    </div>
                `;
            }).join('');
        }

        function selectFood(foodName) {
            showNotification('üçΩÔ∏è', 'ƒê√£ ch·ªçn m√≥n', `B·∫°n ƒë√£ ch·ªçn ${foodName}!`);
        }

        // Recommendation Chat System
        function initializeRecommendationChat() {
            const sendRecChatBtn = document.getElementById('sendRecChatBtn');
            const recChatInput = document.getElementById('recChatInput');
            const recQuickChatBtns = document.querySelectorAll('.rec-quick-chat-btn');
            
            if (sendRecChatBtn && recChatInput) {
                sendRecChatBtn.addEventListener('click', sendRecommendationMessage);
                recChatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendRecommendationMessage();
                    }
                });
            }
            
            recQuickChatBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const message = this.dataset.message;
                    if (recChatInput) {
                        recChatInput.value = message;
                        sendRecommendationMessage();
                    }
                });
            });
        }

        function sendRecommendationMessage() {
            const recChatInput = document.getElementById('recChatInput');
            const recChatContainer = document.getElementById('recChatContainer');
            
            if (!recChatInput || !recChatContainer) return;
            
            const message = recChatInput.value.trim();
            if (!message) return;
            
            // Add user message
            addRecommendationChatMessage(message, 'user');
            recChatInput.value = '';
            
            // Process AI response
            setTimeout(() => {
                const aiResponse = processRecommendationAIRequest(message);
                addRecommendationChatMessage(aiResponse, 'ai');
                
                // Update recommendations based on request
                if (message.toLowerCase().includes('thay') || message.toLowerCase().includes('ƒë·ªïi')) {
                    setTimeout(() => {
                        generateFoodCards();
                        showNotification('üîÑ', 'ƒê√£ c·∫≠p nh·∫≠t', 'G·ª£i √Ω m√≥n ƒÉn ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh!');
                    }, 1500);
                }
            }, 1000);
        }

        function addRecommendationChatMessage(message, sender) {
            const recChatContainer = document.getElementById('recChatContainer');
            if (!recChatContainer) return;
            
            const isUser = sender === 'user';
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}-message mb-3`;
            
            messageDiv.innerHTML = `
                <div class="flex items-start space-x-3 ${isUser ? 'flex-row-reverse space-x-reverse' : ''}">
                    <div class="text-2xl">${isUser ? 'üë§' : 'ü§ñ'}</div>
                    <div class="${isUser ? 'bg-viet-red text-white' : 'bg-blue-100'} rounded-lg p-3 max-w-xs">
                        <p class="text-sm">${message}</p>
                    </div>
                </div>
            `;
            
            recChatContainer.appendChild(messageDiv);
            recChatContainer.scrollTop = recChatContainer.scrollHeight;
        }

        function processRecommendationAIRequest(message) {
            const lowerMessage = message.toLowerCase();
            
            // Handle specific food preferences
            if (lowerMessage.includes('kh√¥ng th√≠ch cay') || lowerMessage.includes('kh√¥ng cay')) {
                // Filter out spicy foods
                return 'T√¥i hi·ªÉu b·∫°n kh√¥ng th√≠ch cay! T√¥i s·∫Ω lo·∫°i b·ªè c√°c m√≥n cay nh∆∞ b√∫n b√≤ Hu·∫ø, l·∫©u Th√°i v√† thay b·∫±ng nh·ªØng m√≥n nh·∫π nh√†ng h∆°n nh∆∞ ch√°o, ph·ªü, salad.';
            }
            
            if (lowerMessage.includes('chay') || lowerMessage.includes('vegetarian')) {
                return 'Tuy·ªát! T√¥i s·∫Ω g·ª£i √Ω c√°c m√≥n chay b·ªï d∆∞·ª°ng nh∆∞ salad quinoa, c∆°m chay, s√∫p rau c·ªß. C√°c m√≥n n√†y v·ª´a healthy v·ª´a ngon mi·ªáng!';
            }
            
            if (lowerMessage.includes('tr√°ng mi·ªáng') || lowerMessage.includes('dessert')) {
                return 'T√¥i s·∫Ω th√™m m·ªôt s·ªë m√≥n tr√°ng mi·ªáng nh·∫π nh√†ng nh∆∞ ch√®, smoothie bowl, tr√°i c√¢y t∆∞∆°i ƒë·ªÉ ho√†n thi·ªán b·ªØa ƒÉn c·ªßa b·∫°n!';
            }
            
            if (lowerMessage.includes('nhanh') || lowerMessage.includes('fast')) {
                return 'T√¥i s·∫Ω ∆∞u ti√™n c√°c m√≥n ƒÉn nhanh nh∆∞ sandwich, salad, m√¨ √Ω, b√°nh m√¨ - nh·ªØng m√≥n c√≥ th·ªÉ chu·∫©n b·ªã trong 15-20 ph√∫t!';
            }
            
            if (lowerMessage.includes('thay') || lowerMessage.includes('ƒë·ªïi')) {
                return 'ƒê√£ hi·ªÉu! T√¥i s·∫Ω thay ƒë·ªïi g·ª£i √Ω m√≥n ƒÉn theo y√™u c·∫ßu c·ªßa b·∫°n. Vui l√≤ng ƒë·ª£i m·ªôt ch√∫t ƒë·ªÉ t√¥i t√¨m nh·ªØng m√≥n ph√π h·ª£p h∆°n...';
            }
            
            if (lowerMessage.includes('protein') || lowerMessage.includes('gym')) {
                return 'T√¥i s·∫Ω t·∫≠p trung v√†o c√°c m√≥n gi√†u protein nh∆∞ c∆°m g√†, salad v·ªõi th·ªãt n∆∞·ªõng, tr·ª©ng ƒë·ªÉ h·ªó tr·ª£ t·∫≠p luy·ªán c·ªßa b·∫°n!';
            }
            
            if (lowerMessage.includes('gi·∫£m c√¢n') || lowerMessage.includes('diet')) {
                return 'T√¥i s·∫Ω ch·ªçn nh·ªØng m√≥n √≠t calories, nhi·ªÅu ch·∫•t x∆° nh∆∞ salad, s√∫p rau, ch√°o ƒë·ªÉ h·ªó tr·ª£ m·ª•c ti√™u gi·∫£m c√¢n c·ªßa b·∫°n!';
            }
            
            // Default responses
            const responses = [
                'T√¥i hi·ªÉu s·ªü th√≠ch c·ªßa b·∫°n! H√£y cho t√¥i bi·∫øt c·ª• th·ªÉ h∆°n v·ªÅ m√≥n n√†o b·∫°n mu·ªën thay ƒë·ªïi.',
                'B·∫°n c√≥ th·ªÉ m√¥ t·∫£ r√µ h∆°n v·ªÅ kh·∫©u v·ªã ho·∫∑c lo·∫°i m√≥n ƒÉn b·∫°n y√™u th√≠ch kh√¥ng?',
                'T√¥i s·∫µn s√†ng ƒëi·ªÅu ch·ªânh g·ª£i √Ω theo √Ω b·∫°n! B·∫°n mu·ªën thay ƒë·ªïi g√¨?'
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        // Meal Plan System
        let currentWeekPlan = {};
        let chatHistory = [];

        function initializeMealPlan() {
            generateWeeklyPlan();
            initializeChat();
            
            // Event listeners
            const generatePlanBtn = document.getElementById('generatePlanBtn');
            const generateSmartPlanBtn = document.getElementById('generateSmartPlanBtn');
            const savePlanBtn = document.getElementById('savePlanBtn');
            const prevWeekBtn = document.getElementById('prevWeekBtn');
            const nextWeekBtn = document.getElementById('nextWeekBtn');
            
            if (generatePlanBtn) {
                generatePlanBtn.addEventListener('click', () => {
                    generateWeeklyPlan();
                    showNotification('üéØ', 'K·∫ø ho·∫°ch m·ªõi', 'ƒê√£ t·∫°o k·∫ø ho·∫°ch ƒÉn u·ªëng m·ªõi!');
                });
            }
            
            if (generateSmartPlanBtn) {
                generateSmartPlanBtn.addEventListener('click', () => {
                    generateSmartWeeklyPlan();
                    showNotification('ü§ñ', 'AI ƒëang t·∫°o', 'ƒêang t·∫°o k·∫ø ho·∫°ch th√¥ng minh theo s·ªü th√≠ch...');
                });
            }
            
            if (savePlanBtn) {
                savePlanBtn.addEventListener('click', () => {
                    showNotification('üíæ', 'ƒê√£ l∆∞u', 'K·∫ø ho·∫°ch ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!');
                });
            }
            
            if (prevWeekBtn) {
                prevWeekBtn.addEventListener('click', () => {
                    showNotification('üìÖ', 'Tu·∫ßn tr∆∞·ªõc', 'ƒêang t·∫£i k·∫ø ho·∫°ch tu·∫ßn tr∆∞·ªõc...');
                });
            }
            
            if (nextWeekBtn) {
                nextWeekBtn.addEventListener('click', () => {
                    showNotification('üìÖ', 'Tu·∫ßn sau', 'ƒêang t·∫£i k·∫ø ho·∫°ch tu·∫ßn sau...');
                });
            }
        }

        function generateWeeklyPlan() {
            const days = ['Th·ª© 2', 'Th·ª© 3', 'Th·ª© 4', 'Th·ª© 5', 'Th·ª© 6', 'Th·ª© 7', 'Ch·ªß nh·∫≠t'];
            const meals = ['S√°ng', 'Tr∆∞a', 'T·ªëi'];
            const mealColors = ['bg-yellow-100 border-yellow-300', 'bg-green-100 border-green-300', 'bg-blue-100 border-blue-300'];
            const mealIcons = ['‚òÄÔ∏è', 'üåû', 'üåô'];
            
            const weeklyPlanContainer = document.getElementById('weeklyPlan');
            if (!weeklyPlanContainer) return;
            
            currentWeekPlan = {};
            
            weeklyPlanContainer.innerHTML = days.map((day, dayIndex) => {
                currentWeekPlan[day] = {};
                
                const dayMeals = meals.map((meal, mealIndex) => {
                    const randomFood = foodDatabase[Math.floor(Math.random() * foodDatabase.length)];
                    currentWeekPlan[day][meal] = randomFood;
                    
                    return `
                        <div class="${mealColors[mealIndex]} border-2 p-4 rounded-xl cursor-pointer hover:shadow-lg hover:scale-105 transition-all meal-card" 
                             data-day="${day}" data-meal="${meal}" onclick="editMeal('${day}', '${meal}')">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-lg">${mealIcons[mealIndex]}</span>
                                <span class="text-xs font-bold text-gray-600">${meal}</span>
                            </div>
                            <div class="text-3xl mb-2 text-center">${randomFood.emoji}</div>
                            <div class="text-sm font-semibold text-center mb-1">${randomFood.name}</div>
                            <div class="text-xs text-gray-500 text-center">${randomFood.calories} cal</div>
                            <div class="text-xs text-gray-400 text-center mt-1">${randomFood.cookTime}</div>
                        </div>
                    `;
                }).join('');
                
                return `
                    <div class="bg-white rounded-xl p-4 shadow-md">
                        <h3 class="font-bold text-lg mb-4 text-center text-viet-red border-b pb-2">${day}</h3>
                        <div class="space-y-3">
                            ${dayMeals}
                        </div>
                    </div>
                `;
            }).join('');
            
            updateNutritionSummary();
        }

        function generateSmartWeeklyPlan() {
            const healthGoal = document.getElementById('healthGoalSelect')?.value || 'maintain';
            const cookingTime = document.getElementById('cookingTimeSelect')?.value || 'any';
            const dietType = document.getElementById('dietTypeSelect')?.value || 'normal';
            
            const days = ['Th·ª© 2', 'Th·ª© 3', 'Th·ª© 4', 'Th·ª© 5', 'Th·ª© 6', 'Th·ª© 7', 'Ch·ªß nh·∫≠t'];
            const meals = ['S√°ng', 'Tr∆∞a', 'T·ªëi'];
            const mealColors = ['bg-yellow-100 border-yellow-300', 'bg-green-100 border-green-300', 'bg-blue-100 border-blue-300'];
            const mealIcons = ['‚òÄÔ∏è', 'üåû', 'üåô'];
            
            const weeklyPlanContainer = document.getElementById('weeklyPlan');
            if (!weeklyPlanContainer) return;
            
            currentWeekPlan = {};
            
            weeklyPlanContainer.innerHTML = days.map((day, dayIndex) => {
                currentWeekPlan[day] = {};
                
                const dayMeals = meals.map((meal, mealIndex) => {
                    const mealType = meal.toLowerCase() === 's√°ng' ? 'breakfast' : 
                                   meal.toLowerCase() === 'tr∆∞a' ? 'lunch' : 'dinner';
                    
                    // Filter foods based on preferences
                    let filteredFoods = foodDatabase.filter(food => {
                        let matches = true;
                        
                        // Filter by meal type
                        if (food.type && food.type !== mealType) {
                            matches = false;
                        }
                        
                        // Filter by diet type
                        if (dietType === 'vegetarian' && food.category !== 'vegetarian') {
                            matches = false;
                        } else if (dietType === 'healthy' && food.health < 80) {
                            matches = false;
                        } else if (dietType === 'traditional' && food.category !== 'traditional') {
                            matches = false;
                        }
                        
                        // Filter by cooking time
                        if (cookingTime === 'quick' && food.time < 70) {
                            matches = false;
                        } else if (cookingTime === 'medium' && (food.time < 40 || food.time > 70)) {
                            matches = false;
                        } else if (cookingTime === 'slow' && food.time > 60) {
                            matches = false;
                        }
                        
                        // Filter by health goal
                        if (healthGoal === 'lose' && food.calories > 350) {
                            matches = false;
                        } else if (healthGoal === 'gain' && food.calories < 300) {
                            matches = false;
                        } else if (healthGoal === 'muscle' && food.health < 75) {
                            matches = false;
                        }
                        
                        return matches;
                    });
                    
                    // If no foods match criteria, use all foods of that meal type
                    if (filteredFoods.length === 0) {
                        filteredFoods = foodDatabase.filter(food => !food.type || food.type === mealType);
                    }
                    
                    // If still no foods, use all foods
                    if (filteredFoods.length === 0) {
                        filteredFoods = foodDatabase;
                    }
                    
                    const selectedFood = filteredFoods[Math.floor(Math.random() * filteredFoods.length)];
                    currentWeekPlan[day][meal] = selectedFood;
                    
                    return `
                        <div class="${mealColors[mealIndex]} border-2 p-4 rounded-xl cursor-pointer hover:shadow-lg hover:scale-105 transition-all meal-card" 
                             data-day="${day}" data-meal="${meal}" onclick="editMeal('${day}', '${meal}')">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-lg">${mealIcons[mealIndex]}</span>
                                <span class="text-xs font-bold text-gray-600">${meal}</span>
                            </div>
                            <div class="text-3xl mb-2 text-center">${selectedFood.emoji}</div>
                            <div class="text-sm font-semibold text-center mb-1">${selectedFood.name}</div>
                            <div class="text-xs text-gray-500 text-center">${selectedFood.calories} cal</div>
                            <div class="text-xs text-gray-400 text-center mt-1">${selectedFood.cookTime}</div>
                            <div class="text-xs text-center mt-2">
                                <span class="bg-white px-2 py-1 rounded-full text-gray-600">
                                    ${getHealthGoalBadge(selectedFood, healthGoal)}
                                </span>
                            </div>
                        </div>
                    `;
                }).join('');
                
                return `
                    <div class="bg-white rounded-xl p-4 shadow-md">
                        <h3 class="font-bold text-lg mb-4 text-center text-viet-red border-b pb-2">${day}</h3>
                        <div class="space-y-3">
                            ${dayMeals}
                        </div>
                    </div>
                `;
            }).join('');
            
            updateNutritionSummary();
            
            // Show success message with plan details
            setTimeout(() => {
                const goalText = {
                    'maintain': 'duy tr√¨ s·ª©c kh·ªèe',
                    'lose': 'gi·∫£m c√¢n',
                    'gain': 'tƒÉng c√¢n',
                    'muscle': 'tƒÉng c∆° b·∫Øp'
                };
                
                const dietText = {
                    'normal': 'b√¨nh th∆∞·ªùng',
                    'vegetarian': 'chay',
                    'healthy': 'healthy',
                    'traditional': 'truy·ªÅn th·ªëng'
                };
                
                showNotification('‚úÖ', 'Ho√†n th√†nh!', `ƒê√£ t·∫°o k·∫ø ho·∫°ch ${goalText[healthGoal]} v·ªõi ch·∫ø ƒë·ªô ƒÉn ${dietText[dietType]}!`);
            }, 1500);
        }

        function getHealthGoalBadge(food, healthGoal) {
            switch(healthGoal) {
                case 'lose':
                    return food.calories < 300 ? 'üî• Gi·∫£m c√¢n' : '‚ö° NƒÉng l∆∞·ª£ng';
                case 'gain':
                    return food.calories > 400 ? 'üí™ TƒÉng c√¢n' : 'üçΩÔ∏è B·ªï d∆∞·ª°ng';
                case 'muscle':
                    return food.health > 80 ? 'üèãÔ∏è TƒÉng c∆°' : 'üí™ Protein';
                default:
                    return food.health > 85 ? 'üåü Healthy' : 'üòã Ngon';
            }
        }

        function editMeal(day, meal) {
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.value = `Thay m√≥n ${meal.toLowerCase()} ${day} th√†nh `;
                chatInput.focus();
            }
        }

        function updateNutritionSummary() {
            let totalCalories = 0;
            let mealCount = 0;
            
            Object.values(currentWeekPlan).forEach(dayPlan => {
                Object.values(dayPlan).forEach(meal => {
                    totalCalories += meal.calories;
                    mealCount++;
                });
            });
            
            const avgCaloriesPerDay = Math.round(totalCalories / 7);
            
            const weeklyCalories = document.getElementById('weeklyCalories');
            const weeklyProtein = document.getElementById('weeklyProtein');
            const weeklyCarbs = document.getElementById('weeklyCarbs');
            const weeklyFat = document.getElementById('weeklyFat');
            
            if (weeklyCalories) weeklyCalories.textContent = avgCaloriesPerDay.toLocaleString();
            if (weeklyProtein) weeklyProtein.textContent = Math.round(avgCaloriesPerDay * 0.15 / 4) + 'g';
            if (weeklyCarbs) weeklyCarbs.textContent = Math.round(avgCaloriesPerDay * 0.55 / 4) + 'g';
            if (weeklyFat) weeklyFat.textContent = Math.round(avgCaloriesPerDay * 0.30 / 9) + 'g';
        }

        // AI Chat System
        function initializeChat() {
            const sendChatBtn = document.getElementById('sendChatBtn');
            const chatInput = document.getElementById('chatInput');
            const quickChatBtns = document.querySelectorAll('.quick-chat-btn');
            
            if (sendChatBtn && chatInput) {
                sendChatBtn.addEventListener('click', sendMessage);
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }
            
            quickChatBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const message = this.dataset.message;
                    if (chatInput) {
                        chatInput.value = message;
                        sendMessage();
                    }
                });
            });
        }

        function sendMessage() {
            const chatInput = document.getElementById('chatInput');
            const chatContainer = document.getElementById('chatContainer');
            
            if (!chatInput || !chatContainer) return;
            
            const message = chatInput.value.trim();
            if (!message) return;
            
            // Add user message
            addChatMessage(message, 'user');
            chatInput.value = '';
            
            // Process AI response
            setTimeout(() => {
                const aiResponse = processAIRequest(message);
                addChatMessage(aiResponse, 'ai');
            }, 1000);
        }

        function addChatMessage(message, sender) {
            const chatContainer = document.getElementById('chatContainer');
            if (!chatContainer) return;
            
            const isUser = sender === 'user';
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}-message mb-3`;
            
            messageDiv.innerHTML = `
                <div class="flex items-start space-x-3 ${isUser ? 'flex-row-reverse space-x-reverse' : ''}">
                    <div class="text-2xl">${isUser ? 'üë§' : 'ü§ñ'}</div>
                    <div class="${isUser ? 'bg-viet-red text-white' : 'bg-blue-100'} rounded-lg p-3 max-w-xs">
                        <p class="text-sm">${message}</p>
                    </div>
                </div>
            `;
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function processAIRequest(message) {
            const lowerMessage = message.toLowerCase();
            
            // Detect meal change requests
            if (lowerMessage.includes('thay') || lowerMessage.includes('ƒë·ªïi')) {
                const days = ['th·ª© 2', 'th·ª© 3', 'th·ª© 4', 'th·ª© 5', 'th·ª© 6', 'th·ª© 7', 'ch·ªß nh·∫≠t'];
                const meals = ['s√°ng', 'tr∆∞a', 't·ªëi'];
                
                let foundDay = null;
                let foundMeal = null;
                
                days.forEach(day => {
                    if (lowerMessage.includes(day)) {
                        foundDay = day.charAt(0).toUpperCase() + day.slice(1);
                    }
                });
                
                meals.forEach(meal => {
                    if (lowerMessage.includes(meal)) {
                        foundMeal = meal.charAt(0).toUpperCase() + meal.slice(1);
                    }
                });
                
                if (foundDay && foundMeal) {
                    // Find a suitable replacement
                    let newFood;
                    if (lowerMessage.includes('healthy') || lowerMessage.includes('kh·ªèe')) {
                        newFood = foodDatabase.filter(f => f.health > 80)[Math.floor(Math.random() * foodDatabase.filter(f => f.health > 80).length)];
                    } else if (lowerMessage.includes('nhanh') || lowerMessage.includes('quick')) {
                        newFood = foodDatabase.filter(f => f.time > 70)[Math.floor(Math.random() * foodDatabase.filter(f => f.time > 70).length)];
                    } else {
                        newFood = foodDatabase[Math.floor(Math.random() * foodDatabase.length)];
                    }
                    
                    // Update the meal plan
                    if (currentWeekPlan[foundDay]) {
                        currentWeekPlan[foundDay][foundMeal] = newFood;
                        generateWeeklyPlan(); // Refresh the display
                        updateNutritionSummary();
                        
                        return `ƒê√£ thay m√≥n ${foundMeal.toLowerCase()} ${foundDay} th√†nh ${newFood.name} ${newFood.emoji}! M√≥n n√†y c√≥ ${newFood.calories} calories v√† r·∫•t ph√π h·ª£p v·ªõi y√™u c·∫ßu c·ªßa b·∫°n.`;
                    }
                }
            }
            
            // Handle general requests
            if (lowerMessage.includes('healthy') || lowerMessage.includes('kh·ªèe')) {
                return 'T√¥i s·∫Ω ∆∞u ti√™n c√°c m√≥n ƒÉn healthy v·ªõi nhi·ªÅu rau xanh v√† √≠t calories. B·∫°n c√≥ mu·ªën t√¥i thay ƒë·ªïi to√†n b·ªô k·∫ø ho·∫°ch theo h∆∞·ªõng healthy kh√¥ng?';
            }
            
            if (lowerMessage.includes('vi·ªát nam') || lowerMessage.includes('vi·ªát')) {
                return 'Tuy·ªát! T√¥i s·∫Ω t·∫≠p trung v√†o c√°c m√≥n ƒÉn Vi·ªát Nam truy·ªÅn th·ªëng nh∆∞ ph·ªü, b√∫n, c∆°m t·∫•m. B·∫°n c√≥ m√≥n Vi·ªát n√†o y√™u th√≠ch ƒë·∫∑c bi·ªát kh√¥ng?';
            }
            
            if (lowerMessage.includes('calories') || lowerMessage.includes('gi·∫£m c√¢n')) {
                return 'T√¥i s·∫Ω ch·ªçn nh·ªØng m√≥n ƒÉn √≠t calories v√† gi√†u protein ƒë·ªÉ h·ªó tr·ª£ gi·∫£m c√¢n. M·ª•c ti√™u calories h√†ng ng√†y c·ªßa b·∫°n l√† bao nhi√™u?';
            }
            
            if (lowerMessage.includes('nhanh') || lowerMessage.includes('n·∫•u nhanh')) {
                return 'T√¥i hi·ªÉu b·∫°n c·∫ßn nh·ªØng m√≥n n·∫•u nhanh! T√¥i s·∫Ω ∆∞u ti√™n c√°c m√≥n c√≥ th·ªÉ ho√†n th√†nh trong 30 ph√∫t nh∆∞ salad, sandwich, m√¨ √Ω...';
            }
            
            // Default responses
            const responses = [
                'T√¥i hi·ªÉu y√™u c·∫ßu c·ªßa b·∫°n! H√£y cho t√¥i bi·∫øt c·ª• th·ªÉ h∆°n v·ªÅ m√≥n ƒÉn ho·∫∑c ng√†y b·∫°n mu·ªën thay ƒë·ªïi.',
                'B·∫°n c√≥ th·ªÉ n√≥i r√µ h∆°n v·ªÅ m√≥n ƒÉn n√†o b·∫°n mu·ªën thay ƒë·ªïi kh√¥ng? V√≠ d·ª•: "Thay m√≥n s√°ng th·ª© 2 th√†nh ch√°o"',
                'T√¥i s·∫µn s√†ng gi√∫p b·∫°n ƒëi·ªÅu ch·ªânh k·∫ø ho·∫°ch! B·∫°n mu·ªën thay ƒë·ªïi theo h∆∞·ªõng n√†o?'
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        // Notification system
        function showNotification(icon, title, message) {
            const notification = document.getElementById('notification');
            const notificationIcon = document.getElementById('notificationIcon');
            const notificationTitle = document.getElementById('notificationTitle');
            const notificationMessage = document.getElementById('notificationMessage');
            
            if (notification && notificationIcon && notificationTitle && notificationMessage) {
                notificationIcon.textContent = icon;
                notificationTitle.textContent = title;
                notificationMessage.textContent = message;
                
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'971b710254630959',t:'MTc1NTYyNTI4My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
